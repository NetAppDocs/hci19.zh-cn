---
sidebar: sidebar 
permalink: docs/task_hci_hserieschassisrepl.html 
summary: 如果机箱出现风扇故障或电源问题描述，应尽快更换。机箱更换操作步骤中的步骤取决于您的 NetApp HCI 配置和集群容量，这需要仔细考虑和规划。您应联系 NetApp 支持部门获取指导并订购更换机箱。 
keywords: netapp, hci, chassis replacement,2U chassis replacement, h-series 
---
= 更换 2U H 系列机箱
:hardbreaks:
:allow-uri-read: 
:nofooter: 
:icons: font
:linkattrs: 
:imagesdir: ../media/


[role="lead"]
如果机箱出现风扇故障或电源问题描述，应尽快更换。机箱更换操作步骤中的步骤取决于您的 NetApp HCI 配置和集群容量，这需要仔细考虑和规划。您应联系 NetApp 支持部门获取指导并订购更换机箱。

.关于此任务
在更换机箱之前，应考虑以下事项：

* 您的机架是否为新机箱提供了额外空间？
* 您的部署中是否有任何机箱具有未使用的节点插槽？
* 如果您的机架具有额外空间，是否可以将每个节点从故障机箱移动到新机箱，一次移动一个？请记住，此过程可能需要一些时间。
* 删除故障机箱中的节点后，存储集群是否可以保持联机？
* 删除故障机箱中的计算节点后，虚拟机（ VM ）和 ESXi 集群是否可以处理此工作负载？


.更换选项
从以下选项中选择一项：<<如果机架中有更多未使用的空间，请更换机箱>>
<<如果机架中没有其他未使用的空间，请更换机箱>>



== 如果机架中有更多未使用的空间，请更换机箱

如果机架具有额外空间，则可以安装新机箱，并一次将一个节点移动到新机箱。如果安装的任何机箱具有未使用的节点插槽，您可以将节点从故障机箱移动到未使用的插槽，一次移动一个，然后移除故障机箱。在成为操作步骤之前，请确保缆线长度足够，并且交换机端口可用。


NOTE: 移动计算节点的步骤与移动存储节点的步骤不同。移动节点之前，应确保节点已正确关闭。从故障机箱中移动所有节点后，您应从机架中卸下机箱并将其退回给 NetApp 。



=== 安装新机箱

您可以将新机箱安装到可用的机架空间中，然后将节点移入该机箱。

.您需要的内容
* 您已佩戴静电释放（ ESD ）腕带，或者已采取其他防静电保护措施。
* 您已更换机箱。
* 您有一台或两个人或更多人来执行这些步骤。
* 您有一个 1 号十字螺丝刀。


.步骤
. Put on antistatic protection.
. 拆开备用机箱的包装。将故障机箱退回 NetApp 时，请保留包装。
. 插入随机箱一起提供的导轨。
. 将替代机箱滑入机架。
+

TIP: 安装机箱时，请始终配备足够的人力或搬运设备。

. 使用正面安装翼形螺钉将机箱固定到机架上，然后使用螺丝刀拧紧螺钉。




=== 移动计算节点

在将计算节点移至新机箱或具有其他未使用插槽的现有机箱之前，您应先迁移虚拟机（ VM ），正确关闭节点并为插入节点的缆线贴上标签。


NOTE: 移动节点时，请确保具有防静电保护。

.步骤
. 记下节点背面标签上的节点序列号。
. 在 VMware vSphere Web Client 中，选择 * 主机和集群 * ，选择一个节点（主机），然后选择 * 监控 > 硬件状态 > 传感器 * 。
. 在 * 传感器 * 部分中，查找您从节点背面的标签上记下的序列号。
. 找到匹配的序列号后，将 VM 迁移到另一个可用主机。
+

NOTE: 有关迁移步骤，请参见 VMware 文档。

. 右键单击节点，然后选择 * 电源 > 关闭 * 。现在，您可以从机箱中物理删除节点了。
. 为节点及其背面的所有缆线贴上标签。
. 向下拉每个节点右侧的凸轮把手，然后使用两个凸轮把手拉出节点，从而从机箱中删除节点。
. 将节点推入新机箱，直到听到卡嗒声为止，从而将此节点重新安装到新机箱中。删除节点之前附加到该节点的标签有助于指导您完成此操作。正确安装节点后，节点将自动启动。
+

CAUTION: 确保在安装节点时从下支持该节点。将节点推入机箱时，请勿用力过大。

+

NOTE: 如果要安装到新机箱中，请确保将节点安装到机箱中的原始插槽中。

. 将缆线重新连接到节点背面的相同端口。断开缆线连接时，缆线上的标签可为您提供指导。
+

CAUTION: 请确保不要将缆线强行插入端口；否则可能会损坏缆线，端口或两者。

. 确认计算节点（主机）已在 VMware vSphere Web Client 的 ESXi 集群中列出。
. 对发生故障的机箱中的所有计算节点执行以下步骤。




=== 移动存储节点

在将存储节点移至新机箱之前，您应先卸下驱动器，正确关闭节点并为所有组件贴上标签。

.步骤
. 确定要删除的节点，如下所示：
+
.. 记下节点背面标签上的节点序列号。
.. 在 VMware vSphere Web Client 中，选择 * NetApp Element Management* ，然后复制 MVIP IP 地址。
.. 使用 Web 浏览器中的 MVIP IP 地址使用您在 NetApp 部署引擎中配置的用户名和密码登录到 NetApp Element 软件 UI 。
.. 选择 * 集群 > 节点 * 。
.. 将记下的序列号与列出的序列号（服务标签）进行匹配。
.. 记下节点的节点 ID 。


. 确定节点后，使用以下 API 调用将 iSCSI 会话从该节点移出： `wget -no-check-certificate -q -username=-password=<pass> -O - -post-data ' ｛ "method ： "movePrimariesawayFromNode" ， "params" ： ｛ "nodeID"< ｝ ： https://<MVIP>/json-rpc/8.0`[]MVIP 是 MVIP IP 地址， nodeID 是节点 ID ， user 是您在设置 NetApp HCI 时在 NetApp 部署引擎中配置的用户名， P直通 是您在设置 NetApp HCI 时在 NetApp 部署引擎中配置的密码。
. 选择 * 集群 > 驱动器 * 以删除与节点关联的驱动器。
+

NOTE: 在删除节点之前，您应等待已删除的驱动器显示为可用。

. 选择 * 集群 > 节点 > 操作 > 删除 * 以删除此节点。
. 使用以下 API 调用关闭节点： `wget -no-check-certificate -q -username=-password=<pass> -O - -post-data ' ｛ "method ： "shutdown" ， "params" ： ｛ "option" ： "halt" ， "nodes" ： [ <nodeid>] ｝ https://<MVIP>/json-rpc/8.0`[]MVIP 是 MVIP IP 地址， nodeID 是节点 ID ， user 是您在设置 NetApp HCI 时在 NetApp 部署引擎中配置的用户名， P直通 是您在设置 NetApp HCI 时在 NetApp 部署引擎中配置的密码。关闭节点后，您可以将其从机箱中物理卸下。
. 按照以下步骤从机箱中的节点中删除驱动器：
+
.. 卸下挡板。
.. 标记驱动器。
.. 打开凸轮把手，然后用双手小心地滑出每个驱动器。
.. 将驱动器放在防静电的水平表面上。


. 按如下所示从机箱中删除节点：
+
.. 为节点及其连接的缆线贴上标签。
.. 向下拉每个节点右侧的凸轮把手，然后使用两个凸轮把手拉出节点。


. 将节点推入机箱中，直到听到卡嗒声为止，以便将此节点重新安装到机箱中。删除节点之前附加到该节点的标签有助于指导您完成此操作。
+

CAUTION: 确保在安装节点时从下支持该节点。将节点推入机箱时，请勿用力过大。

+

NOTE: 如果要安装到新机箱中，请确保将节点安装到机箱中的原始插槽中。

. 向下按每个驱动器上的凸轮把手，直至其卡入到节点中相应的插槽中，以将驱动器安装到其中。
. 将缆线重新连接到节点背面的相同端口。断开电缆连接时所连接的标签将有助于指导您。
+

CAUTION: 请确保不要将缆线强行插入端口；否则可能会损坏缆线，端口或两者。

. 节点启动后，将此节点添加到集群中。
+

NOTE: 添加节点并显示在 * 节点 > 活动 * 下可能需要长达 2 分钟的时间。

. 添加驱动器。
. 对机箱中的所有存储节点执行以下步骤。




== 如果机架中没有其他未使用的空间，请更换机箱

如果您的机架没有额外空间，并且部署中的任何机箱都没有未使用的节点插槽，则在执行更换操作步骤之前，您应确定哪些设备可以保持联机（如果有）。

.关于此任务
在更换机箱之前，应考虑以下几点：

* 如果故障机箱中没有存储节点，存储集群是否可以保持联机？如果问题解答不是，则应关闭 NetApp HCI 部署中的所有节点（计算和存储）。如果问题解答为 yes ，则只能关闭故障机箱中的存储节点。
* 如果发生故障的机箱中没有计算节点，虚拟机和 ESXi 集群是否可以保持联机？如果问题解答不是，则必须关闭或迁移相应的 VM ，才能关闭故障机箱中的计算节点。如果问题解答为 yes ，则只能关闭故障机箱中的计算节点。




=== 关闭计算节点

在将计算节点移动到新机箱之前，您应先迁移虚拟机，正确关闭并标记插入节点的缆线。

.步骤
. 记下节点背面标签上的节点序列号。
. 在 VMware vSphere Web Client 中，选择 * 主机和集群 * ，选择一个节点（主机），然后选择 * 监控 > 硬件状态 > 传感器 * 。
. 在 * 传感器 * 部分中，查找您从节点背面的标签上记下的序列号。
. 找到匹配的序列号后，将 VM 迁移到另一个可用主机。
+

NOTE: 有关迁移步骤，请参见 VMware 文档。

. 右键单击节点，然后选择 * 电源 > 关闭 * 。现在，您可以从机箱中物理删除节点了。




=== 关闭存储节点

请参见步骤 <<move a storage node,此处>>。



=== 删除节点

您应确保从机箱中小心地卸下节点并为所有组件贴上标签。物理删除节点的步骤对于存储节点和计算节点都是相同的。对于存储节点，请先删除此驱动器，然后再删除此节点。

.步骤
. 对于存储节点，请按如下所示从机箱中的节点中删除驱动器：
+
.. 卸下挡板。
.. 标记驱动器。
.. 打开凸轮把手，然后用双手小心地滑出每个驱动器。
.. 将驱动器放在防静电的水平表面上。


. 按如下所示从机箱中删除节点：
+
.. 为节点及其连接的缆线贴上标签。
.. 向下拉每个节点右侧的凸轮把手，然后使用两个凸轮把手拉出节点。


. 对要删除的所有节点执行以下步骤。现在，您可以删除故障机箱了。




=== 更换机箱

如果机架没有额外空间，则应卸载故障机箱并将其更换为新机箱。

.步骤
. Put on antistatic protection.
. 拆开备用机箱的包装，并将其放在水平表面上。将故障设备退回 NetApp 时，请保留包装。
. 从机架中卸下故障机箱，并将其放在水平表面上。
+

NOTE: 移动机箱时，请使用足够的人力或搬运设备。

. 卸下导轨。
. 安装更换机箱随附的新导轨。
. 将替代机箱滑入机架。
. 使用正面安装翼形螺钉将机箱固定到机架上，然后使用螺丝刀拧紧螺钉。
. 按如下所示将节点安装到新机箱中：
+
.. 将节点推入机箱中的原始插槽，直到听到卡嗒声为止，从而将此节点重新安装到机箱中的原始插槽中。删除节点之前附加到该节点的标签有助于指导您完成此操作。
+

CAUTION: 确保在安装节点时从下支持该节点。将节点推入机箱时，请勿用力过大。

.. 对于存储节点，向下按每个驱动器上的凸轮把手直至其卡入到节点中相应的插槽中，从而将驱动器安装到这些驱动器中。
.. 将缆线重新连接到节点背面的相同端口。断开电缆连接后，您在这些电缆上连接的标签将为您提供指导。
+

CAUTION: 请确保不要将缆线强行插入端口；否则可能会损坏缆线，端口或两者。



. 确保节点已联机，如下所示：
+
[cols="2*"]
|===
| 选项 | 步骤 


| 如果您在 NetApp HCI 部署中重新安装了所有节点（存储和计算）  a| 
.. 在 VMware vSphere Web Client 中，确认计算节点（主机）已列在 ESXi 集群中。
.. 在适用于 vCenter Server 的 Element 插件中，确认存储节点已列为 "Active" 。




| 如果您仅在发生故障的机箱中重新安装节点  a| 
.. 在 VMware vSphere Web Client 中，确认计算节点（主机）已列在 ESXi 集群中。
.. 在适用于 vCenter Server 的 Element 插件中，选择 * 集群 > 节点 > 待定 * 。
.. 选择节点，然后选择 * 添加 * 。
+

NOTE: 添加节点并显示在 * 节点 > 活动 * 下可能需要长达 2 分钟的时间。

.. 选择 * 驱动器 * 。
.. 从可用列表中，添加驱动器。
.. 对您重新安装的所有存储节点执行以下步骤。


|===
. 验证卷和数据存储库是否已启动且可访问。




== 了解更多信息

* https://www.netapp.com/us/documentation/hci.aspx["NetApp HCI 资源页面"^]
* http://docs.netapp.com/sfe-122/index.jsp["SolidFire 和 Element 软件文档中心"^]

